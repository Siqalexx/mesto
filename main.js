(()=>{"use strict";const e=class{constructor(e,t){this._obj=e,this._formElement=t,this._inputList=Array.from(this._formElement.querySelectorAll(this._obj.inputSelector)),this._formButton=this._formElement.querySelector(this._obj.submitButtonSelector)}_formIsValid=()=>!this._inputList.some((e=>!e.validity.valid));resetInputs=()=>{const e=Array.from(this._formElement.querySelectorAll(".popup__input-error"));this._inputList.forEach((e=>{e.classList.remove(this._obj.inputErrorClass)})),e.forEach((e=>{e.textContent="",e.classList.remove(this._obj.errorClass)}))};_showError=(e,t)=>{const s=this._formElement.querySelector(`.${e.name}-error`);e.classList.add(this._obj.inputErrorClass),s.classList.add(this._obj.errorClass),s.textContent=t};_hideError=e=>{const t=this._formElement.querySelector(`.${e.name}-error`);e.classList.remove(this._obj.inputErrorClass),t.classList.remove(this._obj.errorClass),t.textContent=""};_checkInputValidity=e=>{e.validity.valid?this._hideError(e):this._showError(e,e.validationMessage)};_disableButton(){this._formButton.classList.add(this._obj.inactiveButtonClass),this._formButton.disabled=!0}_toggleButtonState=()=>{this._formIsValid()?(this._formButton.classList.remove(this._obj.inactiveButtonClass),this._formButton.disabled=!1):this._disableButton()};doButtonInactive=()=>{this._disableButton()};enableValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}};class t{constructor(e){this._popup=document.querySelector(e),this._handleEscClose=this._handleEscClose.bind(this)}open(){document.addEventListener("keydown",this._handleEscClose),this._popup.classList.add("popup_opened")}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose(e){"Escape"==e.key&&this.close()}setEventListeners(){this._popup.addEventListener("mousedown",(e=>{(e.target.classList.contains("popup")||e.target.classList.contains("popup__exit"))&&this.close()}))}}class s extends t{constructor(e,t){super(e),this._handleTodoSubmit=t}_getInputValues(){return Array.from(this._popup.querySelectorAll(".popup__input"))}setEventListeners(){super.setEventListeners();const e=this._getInputValues();this._popup.addEventListener("submit",(t=>this._handleTodoSubmit(t,e)))}close(){this._popup.children[0].reset(),super.close()}}const o={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__submit",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__input-error_visible",formEditingElement:".popup__form_type_editing",nameEditInput:".popup__input_content_name",jobEditInput:".popup__input_content_job"},n=document.querySelector(".elements"),i=document.querySelector(".profile__button-edit"),r=document.querySelector(".profile__add-button"),l=document.querySelector(".popup_profile"),p=document.querySelector(".popup_cards"),a=document.querySelector(o.formEditingElement),c=a.querySelector(o.nameEditInput),u=a.querySelector(o.jobEditInput),d=new e(o,p);d.enableValidation();const _=new e(o,l);_.enableValidation();const h=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._containerSelector=s}addItem(e){this._containerSelector.prepend(e)}renderItems(){this._items.forEach((e=>{this._renderer(e)}))}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>{const t=b(e.link,e.name);n.append(t)}},n);h.renderItems();const m=new s(".popup_cards",(function(e,t){e.preventDefault();const s=b(t[1].value,t[0].value);h.addItem(s),m.close()}));m.setEventListeners();const E=new s(".popup_profile",(function(e,t){e.preventDefault(),f.setUserInfo({newNameEditProfile:t[0].value,newJobEditProfile:t[1].value}),E.close()}));E.setEventListeners();const v=new class extends t{constructor(e){super(e),this._popupNamePhoto=this._popup.querySelector(".popup__image-name"),this._popupLinkPhoto=this._popup.querySelector(".popup__image")}open(e,t){this._popupLinkPhoto.src=e,this._popupLinkPhoto.alt=t,this._popupNamePhoto.textContent=t,super.open()}}(".popup_photos");v.setEventListeners();const f=new class{constructor({nameEditProfile:e,jobEditProfile:t}){this._nameEditProfile=document.querySelector(e),this._jobEditProfile=document.querySelector(t)}getUserInfo(){return{newNameEditProfile:this._nameEditProfile.textContent,newJobEditProfile:this._jobEditProfile.textContent}}setUserInfo({newNameEditProfile:e,newJobEditProfile:t}){this._nameEditProfile.textContent=e,this._jobEditProfile.textContent=t}}({nameEditProfile:".profile__title",jobEditProfile:".profile__subtitle"},o);function y(e,t){v.open(e,t)}function b(e,t){return new class{constructor(e,t,s){this._image=e,this._title=t,this._view=this._getTemplate(),this._handleCardClick=s}_getTemplate(){return document.querySelector("#element-template").content.querySelector(".element").cloneNode(!0)}_addEventListeners(){this._view.querySelector(".element__delete").addEventListener("click",(()=>{this._deleteElement()})),this._view.querySelector(".element__like").addEventListener("click",this._toggleLike),this._view.querySelector(".element__image").addEventListener("click",(()=>{this._handleCardClick(this._image,this._title)}))}_toggleLike(){this.classList.toggle("element__like_active")}_deleteElement(){this._view.remove(),this._view=null}createElement(){const e=this._view.querySelector(".element__image"),t=this._view.querySelector(".element__title");return e.src=this._image,e.alt=this._title,t.textContent=this._title,this._addEventListeners(),this._view}}(e,t,y).createElement()}i.addEventListener("click",(()=>{var e;_.resetInputs(),_.doButtonInactive(l),E.open(),e=f.getUserInfo(),c.value=e.newNameEditProfile,u.value=e.newJobEditProfile})),r.addEventListener("click",(()=>{d.resetInputs(),d.doButtonInactive(p),m.open()})),window.addEventListener("load",(()=>{document.querySelector(".body").classList.remove("preload")}))})();